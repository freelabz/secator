from functools import cache

import requests

from secator.utils import debug
from secator.providers._base import ExploitProvider


class exploitdb(ExploitProvider):
	"""ExploitDB data."""

	@cache
	@staticmethod
	def lookup_exploit(exploit_id):
		"""Lookup a exploit by ID."""
		try:
			resp = requests.get(f'https://exploit-db.com/exploits/{exploit_id}', timeout=5)
			resp.raise_for_status()
			content = resp.content
		except requests.RequestException as e:
			debug(f'Failed remote query for {exploit_id} ({e!s}).', sub='exploit')
			return None
		return content
