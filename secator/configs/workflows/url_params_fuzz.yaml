type: workflow
name: url_params_fuzz
alias: url_params_fuzz
description: Extract and find hidden parameters from URLs
long_description: |
  Identifies and tests URL parameters for vulnerabilities through intelligent fuzzing.
  Extracts parameters from URLs using multiple techniques, then fuzzes them with various payloads
  to discover potential security issues. Probes fuzzed URLs to verify results and optionally
  hunts for secrets in responses. Effective for finding hidden parameters and testing input validation.
tags: [http, fuzz]
input_types:
  - url

options:
  hunt_secrets:
    is_flag: True
    help: Hunt secrets in HTTP responses (trufflehog)
    default: False
    short: hs

  fuzz:
    is_flag: True
    help: Fuzz discovered parameters (ffuf)
    default: False
    short: fuzz

tasks:
  httpx:
    description: Probe URLs and eliminate unresponsive ones
    tech_detect: True
    filter_duplicates: True

  urlparser:
    description: Extract query string parameters from URLs
    include: [url_base]
    targets_:
    - type: url
      field: url

  _group/extract_params:

    arjun:
      description: Extract parameters from URLs
      wordlist: http_params
      targets_:
      - type: tag
        field: value
        condition: item.name == 'url_base'
    x8:
      description: Bruteforce URL params
      wordlist: http_params
      targets_:
      - type: tag
        field: f'{value}/'
        condition: item.name == 'url_base'

  ffuf:
    description: Fuzz URL params
    wordlist: https://raw.githubusercontent.com/trickest/wordlists/refs/heads/main/cloud/levels/level1.txt
    auto_calibration: true
    follow_redirect: true
    targets_:
      - type: tag
        field: '{match}?{value}=FUZZ'
        condition: item._source.startswith('qsextract') or item._source.startswith('arjun') or item._source.startswith('x8')
    if: opts.fuzz

  trufflehog:
    description: Find secrets in HTTP responses
    targets_:
      - type: url
        field: stored_response_path
        condition: item.stored_response_path != ''
    if: opts.hunt_secrets
