type: workflow
name: url_dirsearch
alias: dirfind
description: URL directory search
tags: [http, dir]
input_types:
  - url
tasks:
  _group:
    dirsearch:
      description: Search for HTTP directories
      wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
    ffuf:
      description: Search for HTTP directories
      wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
      targets_:
        - type: target
          field: '{name}/FUZZ'
    httpx:
      description: Run httpx on input URLs
  katana:
    description: Run crawler on found directories
    targets_:
      - type: url
        field: url
        condition: "'Index of' in item.title"  # identified as directories by httpx + page title
      - type: url
        field: url
        condition: item._source == 'ffuf'  # identified as directories by ffuf + wordlist
  cariddi:
    description: Run pattern matcher on directory files
    targets_:
      - type: url
        field: url
        condition: item._source == 'katana'  # directory files identified by katana