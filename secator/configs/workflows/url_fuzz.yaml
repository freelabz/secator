type: workflow
name: url_fuzz
alias: uf
description: URL fuzz (slow)
long_description: |
  Performs comprehensive fuzzing of URLs to discover hidden content and directories.
  Uses multiple fuzzing engines (dirsearch, feroxbuster, ffuf) with intelligent calibration
  to filter false positives. Probes discovered URLs, captures screenshots when configured,
  and optionally hunts for secrets in HTTP responses. Thorough but time-intensive.
tags: [http, fuzz]
input_types:
  - url

default_options:
  auto_calibration: true
  follow_redirect: true

options:
  fuzzers:
    type: list
    required: True
    help: "Fuzzers to use (comma-separated) (dirsearch, feroxbuster, ffuf)"
    default: ['ffuf']

  hunt_secrets:
    is_flag: True
    help: Hunt secrets in HTTP responses (trufflehog)
    default: False
    short: hs

tasks:

  _group/fuzz:
    dirsearch:
      description: Fuzz URLs
      if: "'dirsearch' in opts.fuzzers"

    feroxbuster:
      description: Fuzz URLs
      if: "'feroxbuster' in opts.fuzzers"

    ffuf:
      description: Fuzz URLs
      if: "'ffuf' in opts.fuzzers"
      targets_:
        - type: target
          field: '{name}/FUZZ'

  httpx:
    description: Run HTTP probes on fuzzed URLs
    tech_detect: True
    filter_duplicates: True
    targets_:
      type: url
      field: url
      condition: not url.verified

  trufflehog:
    description: Find secrets in HTTP responses
    targets_:
      - type: url
        field: stored_response_path
        condition: item.stored_response_path != ''
    if: opts.hunt_secrets
