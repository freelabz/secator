type: workflow
name: url_secrets_hunt
alias: ush
description: URL secrets hunt
long_description: |
  Searches for exposed secrets, credentials, and sensitive information in web content.
  Probes URLs and analyzes HTTP responses for API keys, passwords, tokens, private keys,
  and other confidential data. Uses TruffleHog to detect various secret patterns.
  Critical for identifying accidental credential exposure and sensitive data leaks.
input_types:
- url

tasks:
  httpx:
    description: Run HTTP probes on URLs
    tech_detect: True

  trufflehog:
    description: Find secrets in HTTP responses
    targets_:
    - type: url
      field: stored_response_path
      condition: item.stored_response_path != ''
